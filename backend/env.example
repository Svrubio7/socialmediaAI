# Copy this file to .env and fill in your values. Never commit real secrets.
#
# Development: DATABASE_URL = Supabase connection string; REDIS_URL = redis://localhost:6379
#   or redis://redis:6379 when running in Docker Compose.
# Production (Render): DATABASE_URL and REDIS_URL set in Render Dashboard (Supabase + Render Redis).
#
# Supabase: Project Settings → Database → Connection string (URI).
DATABASE_URL=postgresql://postgres.[project-ref]:[password]@aws-0-[region].pooler.supabase.com:6543/postgres

# Redis (dev: local or redis://redis:6379 in Docker; prod: Render Redis URL)
REDIS_URL=redis://localhost:6379

# Local file storage (only when STORAGE_BACKEND=local)
LOCAL_STORAGE_DIR=temp/storage
# Optional explicit public base URL for local storage (if blank, backend request host is used)
STORAGE_PUBLIC_BASE_URL=

# Supabase (auth + optional storage)
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_KEY=your-service-role-key
SUPABASE_JWT_SECRET=your-jwt-secret

# Storage backend: "local" or "supabase"
# With supabase: one private bucket (SUPABASE_STORAGE_BUCKET) holds videos/, thumbnails/, editor/outputs/, branding/
# Celery workers need SUPABASE_URL + SUPABASE_KEY to download videos for analysis/export.
STORAGE_BACKEND=local
SUPABASE_STORAGE_BUCKET=videos
SUPABASE_STORAGE_PRIVATE=true
SUPABASE_STORAGE_SIGNED_URL_TTL=3600

# AI APIs
GEMINI_API_KEY=your-gemini-key
OPENAI_API_KEY=your-openai-key

# OAuth - Instagram
INSTAGRAM_CLIENT_ID=your-instagram-client-id
INSTAGRAM_CLIENT_SECRET=your-instagram-client-secret

# OAuth - TikTok
TIKTOK_CLIENT_KEY=your-tiktok-key
TIKTOK_CLIENT_SECRET=your-tiktok-secret

# OAuth - YouTube
YOUTUBE_CLIENT_ID=your-youtube-client-id
YOUTUBE_CLIENT_SECRET=your-youtube-client-secret

# OAuth - Facebook
FACEBOOK_APP_ID=your-facebook-app-id
FACEBOOK_APP_SECRET=your-facebook-app-secret

# Security
ENCRYPTION_KEY=your-32-byte-encryption-key-here
SECRET_KEY=your-secret-key-for-jwt

# Application
DEBUG=false
CORS_ORIGINS=http://localhost:3000,http://127.0.0.1:3000,https://social-media-ai-frontend.onrender.com
# Optional regex for preview deployments (example allows Vercel previews)
CORS_ORIGIN_REGEX=^https://.*\.vercel\.app$
PORT=8000
EDITOR_SIGNED_UPLOAD_RATE_LIMIT=30
EDITOR_SIGNED_UPLOAD_RATE_WINDOW_SEC=60
EDITOR_ENGINE_DEFAULT=opencut
EDITOR_OPENCUT_ENABLED=true

# --- Supabase Storage (when STORAGE_BACKEND=supabase) ---
# Create one private bucket named "videos" in Supabase Dashboard → Storage.
# Paths in that bucket: videos/{uid}/, thumbnails/{uid}/, editor/outputs/{uid}/, branding/{uid}/
# Run this SQL in Supabase SQL Editor to allow authenticated upload/read/delete:
#
# create policy "Users can upload own videos"
# on storage.objects for insert to authenticated
# with check (
#   bucket_id = 'videos'
#   and (name like 'videos/' || auth.uid() || '/%' or name like 'thumbnails/' || auth.uid() || '/%')
# );
# create policy "Users can read own videos"
# on storage.objects for select to authenticated
# using (
#   bucket_id = 'videos'
#   and (name like 'videos/' || auth.uid() || '/%' or name like 'thumbnails/' || auth.uid() || '/%')
# );
# create policy "Users can delete own videos"
# on storage.objects for delete to authenticated
# using (
#   bucket_id = 'videos'
#   and (name like 'videos/' || auth.uid() || '/%' or name like 'thumbnails/' || auth.uid() || '/%')
# );
#
# Editor outputs and branding are written by the backend (service role), so no client policy needed.
